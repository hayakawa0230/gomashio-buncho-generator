// ゲームセッション状態
function createSession() {
    return {
        currentStage: 1,
        remainingSprinkles: 5,
        isHolding: false,
        powerGauge: 0,
        gaugeDirection: 1,
        packageAnim: null,
        transitionFlashFrames: 0,
        isTransitioningStage: false,
        isDraggingSlider: false,
        activeParticles: [],
        settledParticles: [],
        sesameRatio: 0.5
    };
}
let session = createSession();

// 最近作成した画像を保存・読み込み
const RECENT_KEY = 'gomasio-recent';
const RECENT_MAX = 5;
function loadRecentImages() {
    try {
        const data = localStorage.getItem(RECENT_KEY);
        if (!data) return [];
        const parsed = JSON.parse(data);
        return Array.isArray(parsed) ? parsed.slice(0, RECENT_MAX) : [];
    } catch (e) {
        console.error('Failed to load recent images', e);
        return [];
    }
}

function saveRecentImage(dataUrl) {
    const list = loadRecentImages();
    list.unshift(dataUrl);
    const trimmed = list.slice(0, RECENT_MAX);
    try {
        localStorage.setItem(RECENT_KEY, JSON.stringify(trimmed));
    } catch (e) {
        console.error('Failed to save recent images', e);
    }
    renderRecentImages(trimmed);
}

function renderRecentImages(list = loadRecentImages()) {
    if (!recentListEl) return;
    recentListEl.innerHTML = '';
    if (!list.length) {
        recentListEl.textContent = 'まだありません';
        return;
    }
    list.forEach((src) => {
        const img = document.createElement('img');
        img.src = src;
        img.className = 'recent-thumb';
        img.alt = '最近作ったごましお文鳥';
        img.addEventListener('click', () => {
            // 保存画面に遷移しつつ生成はスキップしてサムネを表示
            switchStage(3, { skipGenerate: true });
            const previewImage = document.getElementById('previewImage');
            const overlayPreview = document.getElementById('overlayPreview');
            previewImage.src = src;
            if (overlayPreview) {
                overlayPreview.src = maskImage.src;
            }
        });
        recentListEl.appendChild(img);
    });
}

// Canvas要素
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const cropCanvas = document.getElementById('cropCanvas');
const cropCtx = cropCanvas.getContext('2d');
const previewCanvas = document.getElementById('previewCanvas');
const previewCtx = previewCanvas.getContext('2d');

// ディスプレイサイズとキャンバス内部座標を一致させるためのユーティリティ
function getPointerPosition(evt, targetCanvas) {
    const rect = targetCanvas.getBoundingClientRect();
    const touch = (evt.touches && evt.touches[0]) || (evt.changedTouches && evt.changedTouches[0]);
    const clientX = touch ? touch.clientX : evt.clientX;
    const clientY = touch ? touch.clientY : evt.clientY;

    const scaleX = targetCanvas.width / rect.width;
    const scaleY = targetCanvas.height / rect.height;
    return {
        x: (clientX - rect.left) * scaleX,
        y: (clientY - rect.top) * scaleY
    };
}

// パッケージ画像の読み込み
const packageImage = new Image();
packageImage.src = 'data:image/png;base64,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';


// マスク画像の読み込み
const maskImage = new Image();

// オーバーレイ用マスク画像（保存ミッションで使用）
const overlayMaskImage = new Image();
overlayMaskImage.src = 'data:image/png;base64,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';
let overlayMaskLoaded = false;
overlayMaskImage.onload = () => {
    overlayMaskLoaded = true;
};
maskImage.crossOrigin = "anonymous";
maskImage.src = 'data:image/png;base64,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';
let maskLoaded = false;

maskImage.onload = () => {
    console.log('Mask image loaded successfully');
    maskLoaded = true;
    if (session.currentStage === 2) {
        drawCropCircle();
    }
};

maskImage.onerror = () => {
    console.error('Failed to load mask image');
};

// オフスクリーンキャンバス
const offscreenCanvas = document.createElement('canvas');
offscreenCanvas.width = canvas.width;
offscreenCanvas.height = canvas.height;
const offscreenCtx = offscreenCanvas.getContext('2d');

let gaugeSpeed = 0.025;

// 切り抜き用（マスク画像のサイズと位置）
// 切り抜き初期サイズを少し小さめにする
let cropMask = { x: 240, y: 160, width: 140, height: 140 };
let isDraggingCircle = false;
let isDraggingResize = false;
let dragOffset = { x: 0, y: 0 };

// UI要素
const ratioSlider = document.getElementById('ratioSlider');
const ratioHandle = document.getElementById('ratioHandle');
const ratioFill = document.getElementById('ratioFill');
const saltPercentEl = document.getElementById('saltPercent');
const sesamePercentEl = document.getElementById('sesamePercent');
const remainingCountEl = document.getElementById('remainingCount');
const stageInfoEl = document.getElementById('stageInfo');
const recentListEl = document.getElementById('recentList');

// ミッション切り替え
function switchStage(stage, options = {}) {
    const { skipGenerate = false } = options;
    // ステージ1に戻るときはセッションを丸ごとリセット
    if (stage === 1) {
        session = createSession();
    } else {
        session.currentStage = stage;
        // ステージ間の遷移中フラグは明示的に解除
        session.isTransitioningStage = false;
        session.transitionFlashFrames = 0;
    }

    document.getElementById('stage1').classList.add('hidden');
    document.getElementById('stage2').classList.add('hidden');
    document.getElementById('stage3').classList.add('hidden');

    if (stage === 1) {
        stageInfoEl.textContent = 'ミッション1: ごましおを振れ！';
        document.getElementById('stage1').classList.remove('hidden');
        remainingCountEl.textContent = session.remainingSprinkles;
        offscreenCtx.clearRect(0, 0, offscreenCanvas.width, offscreenCanvas.height);
        session.activeParticles = [];
        session.settledParticles = [];

        // ゲージとアニメーション状態をリセット
        session.isHolding = false;
        session.powerGauge = 0;
        session.gaugeDirection = 1;
        session.packageAnim = null;

        // 切り抜きマスク位置を初期値に戻す
        cropMask = { x: 240, y: 160, width: 140, height: 140 };
        isDraggingCircle = false;
        isDraggingResize = false;
        dragOffset = { x: 0, y: 0 };
        session.sesameRatio = 0.5;
        updateSliderPosition();
    } else if (stage === 2) {
        stageInfoEl.textContent = 'ミッション2: 切り抜け！';
        document.getElementById('stage2').classList.remove('hidden');
        cropCtx.drawImage(offscreenCanvas, 0, 0);
        drawCropCircle();
    } else if (stage === 3) {
        stageInfoEl.textContent = 'ミッション3: 保存せよ！';
        document.getElementById('stage3').classList.remove('hidden');
        if (!skipGenerate) {
            createCroppedImage();
        }
    }

    // 全ステージで最近リストを表示更新
    renderRecentImages();
}

// スライダーの初期位置設定
function updateSliderPosition() {
    const sliderWidth = ratioSlider.offsetWidth;
    const handlePos = session.sesameRatio * sliderWidth;
    ratioHandle.style.left = handlePos + 'px';
    ratioFill.style.width = ((1 - session.sesameRatio) * 100) + '%';

    const saltPercent = Math.round((1 - session.sesameRatio) * 100);
    const sesamePercent = Math.round(session.sesameRatio * 100);
    saltPercentEl.textContent = saltPercent;
    sesamePercentEl.textContent = sesamePercent;
}

function handleSliderMove(clientX) {
    const rect = ratioSlider.getBoundingClientRect();
    const x = clientX - rect.left;
    session.sesameRatio = Math.max(0, Math.min(1, x / rect.width));
    updateSliderPosition();
}

// スライダーイベント
ratioSlider.addEventListener('mousedown', (e) => {
    session.isDraggingSlider = true;
    handleSliderMove(e.clientX);
});

document.addEventListener('mousemove', (e) => {
    if (session.isDraggingSlider) {
        handleSliderMove(e.clientX);
    }
});

document.addEventListener('mouseup', () => {
    session.isDraggingSlider = false;
});

ratioSlider.addEventListener('touchstart', (e) => {
    e.preventDefault();
    session.isDraggingSlider = true;
    handleSliderMove(e.touches[0].clientX);
});

ratioSlider.addEventListener('touchmove', (e) => {
    e.preventDefault();
    if (session.isDraggingSlider) {
        handleSliderMove(e.touches[0].clientX);
    }
});

ratioSlider.addEventListener('touchend', (e) => {
    e.preventDefault();
    session.isDraggingSlider = false;
});

// ウィンドウ幅が変わったら位置を再計算（レスポンシブ対応）
window.addEventListener('resize', updateSliderPosition);

// パーティクルクラス
class Particle {
    constructor(x, y, angle, isBlack, power) {
        this.startX = x;
        this.startY = y;
        this.x = x;
        this.y = y;
        this.z = 0;

        const speed = (Math.random() * 2 + 1) * (0.5 + power * 2.5);
        this.vx = Math.cos(angle) * speed;
        this.vy = Math.sin(angle) * speed;
        this.vz = (Math.random() * 1.5 + 0.5) * (0.5 + power * 2.5);

        this.baseSize = Math.random() * 7 + 5;
        this.isBlack = isBlack;
        this.rotation = Math.random() * Math.PI * 2;
        this.rotationSpeed = (Math.random() - 0.5) * 0.15;
        this.settled = false;
        this.maxZ = Math.random() * 15 + 10;
    }

    update() {
        if (!this.settled) {
            this.z += this.vz;
            this.x += this.vx;
            this.y += this.vy;
            this.rotation += this.rotationSpeed;

            this.vx *= 0.95;
            this.vy *= 0.95;
            this.vz *= 0.92;

            if (this.z >= this.maxZ || Math.abs(this.vz) < 0.01) {
                this.settled = true;
                this.vx = 0;
                this.vy = 0;
                this.vz = 0;
                this.drawToOffscreen();
                session.settledParticles.push({
                    x: this.x,
                    y: this.y,
                    z: this.z,
                    rotation: this.rotation,
                    baseSize: this.baseSize,
                    isBlack: this.isBlack
                });
                return false;
            }
        }
        return !this.settled;
    }

    draw(context) {
        const scale = 1 / (1 + this.z * 0.05);
        const size = this.baseSize * scale;

        if (size < 0.5) return;

        context.save();
        context.translate(this.x, this.y);
        context.rotate(this.rotation);

        if (this.isBlack) {
            context.fillStyle = '#000000';
            context.beginPath();
            context.ellipse(0, 0, size, size * 0.6, 0, 0, Math.PI * 2);
            context.fill();
        } else {
            context.fillStyle = '#f5f5f5';
            context.strokeStyle = '#ddd';
            context.lineWidth = 0.5 * scale;
            context.beginPath();
            context.rect(-size/2, -size/2, size, size);
            context.fill();
            context.stroke();
        }

        context.restore();
    }

    drawToOffscreen() {
        this.draw(offscreenCtx);
    }
}

function sprinkle(x, y, power) {
    console.log('Sprinkle called:', x, y, power, session.remainingSprinkles);
    if (session.remainingSprinkles <= 0 || session.isTransitioningStage) return;

    const particleCount = Math.round((Math.random() * 50 + 100) * (0.5 + power));
    console.log('Creating particles:', particleCount);

    for (let i = 0; i < particleCount; i++) {
        const angle = Math.random() * Math.PI * 2;
        const isBlack = Math.random() < session.sesameRatio;
        session.activeParticles.push(new Particle(x, y, angle, isBlack, power));
    }

    console.log('Active particles:', session.activeParticles.length);
    session.remainingSprinkles--;
    remainingCountEl.textContent = session.remainingSprinkles;

    if (session.remainingSprinkles === 0) {
        session.isTransitioningStage = true;
        session.transitionFlashFrames = 25;
        setTimeout(() => {
            switchStage(2);
        }, 500);
    }
}

function drawPowerGauge() {
    if (!session.isHolding) return;

    const gaugeWidth = 300;
    const gaugeHeight = 40;
    const gaugeX = (canvas.width - gaugeWidth) / 2;
    const gaugeY = 30;

    ctx.fillStyle = 'rgba(0, 0, 0, 0.15)';
    ctx.fillRect(gaugeX - 5, gaugeY - 5, gaugeWidth + 10, gaugeHeight + 10);

    ctx.fillStyle = '#f3eee7';
    ctx.fillRect(gaugeX, gaugeY, gaugeWidth, gaugeHeight);

    const gradient = ctx.createLinearGradient(gaugeX, 0, gaugeX + gaugeWidth, 0);
    gradient.addColorStop(0, '#f7d7a8');
    gradient.addColorStop(0.5, '#ea9a63');
    gradient.addColorStop(1, '#d86d3a');

    ctx.fillStyle = gradient;
    ctx.fillRect(gaugeX, gaugeY, gaugeWidth * session.powerGauge, gaugeHeight);

    ctx.strokeStyle = '#6a4e3c';
    ctx.lineWidth = 2.5;
    ctx.strokeRect(gaugeX, gaugeY, gaugeWidth, gaugeHeight);

    ctx.fillStyle = '#6a4e3c';
    ctx.font = 'bold 18px \"M PLUS Rounded 1c\", sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('パワー', gaugeX + gaugeWidth / 2, gaugeY - 10);

    const powerPercent = Math.round(session.powerGauge * 100);
    ctx.fillStyle = '#6a4e3c';
    ctx.font = 'bold 16px \"M PLUS Rounded 1c\", sans-serif';
    ctx.fillText(powerPercent + '%', gaugeX + gaugeWidth / 2, gaugeY + gaugeHeight / 2 + 6);
}

function drawPackageAnimation() {
    if (!session.packageAnim) return;

    const size = 80;

    if (session.packageAnim.phase === 'holding') {
        // タップ中は静止表示
        ctx.save();
        ctx.translate(session.packageAnim.x, session.packageAnim.y);
        ctx.drawImage(packageImage, -size/2, -size/2, size, size);
        ctx.restore();
    } else if (session.packageAnim.phase === 'shaking') {
        // 振りかけアニメーション
        session.packageAnim.shakeProgress += 0.06;

        if (session.packageAnim.shakeProgress >= 1) {
            // アニメーション終了
            session.packageAnim = null;
            return;
        }

        // 左に120度傾けてから元に戻る動き
        const progress = session.packageAnim.shakeProgress;
        const maxRotation = -120 * Math.PI / 180; // 120度を左に傾ける

        // 前半(0-0.4): 120度まで傾ける
        // 後半(0.4-1): 元に戻る
        let rotation;
        if (progress < 0.4) {
            rotation = maxRotation * (progress / 0.4);
        } else {
            const returnProgress = (progress - 0.4) / 0.6;
            rotation = maxRotation * (1 - returnProgress);
        }

        session.packageAnim.rotation = rotation;
        session.packageAnim.offsetX = -20 * Math.sin(progress * Math.PI); // 左に少し移動して戻る
        session.packageAnim.offsetY = -15 * Math.sin(progress * Math.PI); // 上に少し移動して戻る

        // 後半から徐々にフェードアウト
        const opacity = progress < 0.6 ? 1 : 1 - ((progress - 0.6) / 0.4);

        ctx.save();
        ctx.globalAlpha = opacity;
        ctx.translate(session.packageAnim.x + session.packageAnim.offsetX, session.packageAnim.y + session.packageAnim.offsetY);
        ctx.rotate(session.packageAnim.rotation);
        ctx.drawImage(packageImage, -size/2, -size/2, size, size);
        ctx.restore();
    }
}

function updatePowerGauge() {
    if (!session.isHolding) return;

    session.powerGauge += gaugeSpeed * session.gaugeDirection;

    if (session.powerGauge >= 1) {
        session.powerGauge = 1;
        session.gaugeDirection = -1;
    } else if (session.powerGauge <= 0) {
        session.powerGauge = 0;
        session.gaugeDirection = 1;
    }
}

function animate() {
    if (session.currentStage === 1) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(offscreenCanvas, 0, 0);

        session.activeParticles = session.activeParticles.filter(particle => {
            const stillActive = particle.update();
            if (stillActive) {
                particle.draw(ctx);
            }
            return stillActive;
        });

        updatePowerGauge();
        drawPowerGauge();
        drawPackageAnimation();

        // ステージ切替時の軽いフラッシュ
        if (session.transitionFlashFrames > 0) {
            const alpha = (session.transitionFlashFrames / 25) * 0.6;
            ctx.save();
            ctx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.restore();
            session.transitionFlashFrames--;
        }
    }

    requestAnimationFrame(animate);
}

// ミッション1のキャンバスイベント
canvas.addEventListener('mousedown', (e) => {
    if (session.currentStage === 1 && !session.isDraggingSlider && !session.isTransitioningStage) {
        session.isHolding = true;
        session.powerGauge = 0;

        const { x, y } = getPointerPosition(e, canvas);
        const displayX = x - 60;  // 画像表示位置（左上）
        const displayY = y - 60;
        session.packageAnim = {
            x: displayX,
            y: displayY,
            sprinkleX: displayX - 10,  // ごましお発射点は画像位置のさらに左上
            sprinkleY: displayY + 20,
            phase: 'holding', // 'holding' or 'shaking'
            shakeProgress: 0,
            rotation: 0,
            offsetX: 0,
            offsetY: 0
        };
    }
});

canvas.addEventListener('mouseup', (e) => {
    if (session.currentStage === 1 && session.isHolding) {
        const { x, y } = getPointerPosition(e, canvas);
        // パッケージアニメーションに保存された発射点を使用
        const fireX = session.packageAnim ? session.packageAnim.sprinkleX : (x - 30);
        const fireY = session.packageAnim ? session.packageAnim.sprinkleY : y;
        sprinkle(fireX, fireY, session.powerGauge);
        session.isHolding = false;
        
        // 振りかけアニメーションに切り替え
        if (session.packageAnim) {
            session.packageAnim.phase = 'shaking';
            session.packageAnim.shakeProgress = 0;
        }
    }
});

canvas.addEventListener('mousemove', (e) => {
    if (session.currentStage === 1 && session.isHolding && session.packageAnim && session.packageAnim.phase === 'holding') {
        const { x, y } = getPointerPosition(e, canvas);
        const displayX = x - 60;
        const displayY = y - 60;
        
        session.packageAnim.x = displayX;
        session.packageAnim.y = displayY;
        session.packageAnim.sprinkleX = displayX - 10;
        session.packageAnim.sprinkleY = displayY + 20;
    }
});

canvas.addEventListener('touchstart', (e) => {
    if (session.currentStage === 1 && !session.isTransitioningStage) {
        e.preventDefault();
        session.isHolding = true;
        session.powerGauge = 0;
        
        // パッケージアニメーションを開始
        const { x, y } = getPointerPosition(e, canvas);
        const displayX = x - 60;  // 画像表示位置（左上）
        const displayY = y - 60;
        session.packageAnim = {
            x: displayX,
            y: displayY,
            sprinkleX: displayX - 10,  // ごましお発射点は画像位置のさらに左上
            sprinkleY: displayY + 20,
            phase: 'holding',
            shakeProgress: 0,
            rotation: 0,
            offsetX: 0,
            offsetY: 0
        };
    }
});

canvas.addEventListener('touchmove', (e) => {
    if (session.currentStage === 1 && session.isHolding && session.packageAnim && session.packageAnim.phase === 'holding') {
        e.preventDefault();
        const { x, y } = getPointerPosition(e, canvas);
        const displayX = x - 60;
        const displayY = y - 60;
        
        session.packageAnim.x = displayX;
        session.packageAnim.y = displayY;
        session.packageAnim.sprinkleX = displayX - 10;
        session.packageAnim.sprinkleY = displayY + 20;
    }
});

canvas.addEventListener('touchend', (e) => {
    if (session.currentStage === 1 && session.isHolding) {
        e.preventDefault();
        const { x, y } = getPointerPosition(e, canvas);
        // パッケージアニメーションに保存された発射点を使用
        const fireX = session.packageAnim ? session.packageAnim.sprinkleX : (x - 30);
        const fireY = session.packageAnim ? session.packageAnim.sprinkleY : y;
        sprinkle(fireX, fireY, session.powerGauge);
        session.isHolding = false;
        
        // 振りかけアニメーションに切り替え
        if (session.packageAnim) {
            session.packageAnim.phase = 'shaking';
            session.packageAnim.shakeProgress = 0;
        }
    }
});

// ミッション2: 切り抜き
function getResizeHandlePos() {
    return {
        x: cropMask.x + cropMask.width / 2,
        y: cropMask.y + cropMask.height / 2
    };
}

function drawCropCircle() {
    cropCtx.clearRect(0, 0, cropCanvas.width, cropCanvas.height);
    cropCtx.drawImage(offscreenCanvas, 0, 0);
    cropCtx.fillStyle = 'rgba(0, 0, 0, 0.5)';
    cropCtx.fillRect(0, 0, cropCanvas.width, cropCanvas.height);

    const maskX = cropMask.x - cropMask.width / 2;
    const maskY = cropMask.y - cropMask.height / 2;
    const radius = cropMask.width / 2;
    const renderRadius = radius * 1.25; // 見た目上の抜けを広げる

    if (maskLoaded) {
        cropCtx.save();

        // 円形のぼかしグラデーションでオーバーレイをくり抜く（外周は少し暗めに残す）
        cropCtx.globalCompositeOperation = 'destination-out';
        const gradient = cropCtx.createRadialGradient(
            cropMask.x,
            cropMask.y,
            0,
            cropMask.x,
            cropMask.y,
            renderRadius
        );
        // なめらかに透明へ移行する単一グラデーション
        gradient.addColorStop(0, 'rgba(0, 0, 0, 1)');
        gradient.addColorStop(0.6, 'rgba(0, 0, 0, 0.3)');
        gradient.addColorStop(1, 'rgba(0, 0, 0, 0)');
        cropCtx.fillStyle = gradient;
        cropCtx.beginPath();
        cropCtx.arc(cropMask.x, cropMask.y, renderRadius, 0, Math.PI * 2);
        cropCtx.fill();
        cropCtx.globalCompositeOperation = 'source-over';

        // 円形クリップの中だけ表示
        cropCtx.save();
        cropCtx.beginPath();
        cropCtx.arc(cropMask.x, cropMask.y, radius, 0, Math.PI * 2);
        cropCtx.clip();

        const tempCanvas = document.createElement('canvas');
        tempCanvas.width = cropMask.width;
        tempCanvas.height = cropMask.height;
        const tempCtx = tempCanvas.getContext('2d');
        
        // ごましおを描画
        tempCtx.drawImage(offscreenCanvas, maskX, maskY, cropMask.width, cropMask.height, 0, 0, cropMask.width, cropMask.height);
        
        // キャラクター画像を上に重ねる
        tempCtx.drawImage(maskImage, 0, 0, cropMask.width, cropMask.height);
        
        cropCtx.drawImage(tempCanvas, maskX, maskY);
        cropCtx.restore();
    }
    
    // リサイズハンドル
    const handle = getResizeHandlePos();
    cropCtx.fillStyle = '#fff';
    cropCtx.beginPath();
    cropCtx.arc(handle.x, handle.y, 12, 0, Math.PI * 2);
    cropCtx.fill();

    cropCtx.strokeStyle = '#ea7640';
    cropCtx.lineWidth = 3;
    cropCtx.beginPath();
    cropCtx.arc(handle.x, handle.y, 12, 0, Math.PI * 2);
    cropCtx.stroke();

    cropCtx.strokeStyle = '#ea7640';
    cropCtx.lineWidth = 2;
    cropCtx.lineCap = 'round';

    const arrowSize = 6;
    cropCtx.beginPath();
    cropCtx.moveTo(handle.x - arrowSize, handle.y - arrowSize);
    cropCtx.lineTo(handle.x + arrowSize, handle.y + arrowSize);
    cropCtx.stroke();

    cropCtx.beginPath();
    cropCtx.moveTo(handle.x - arrowSize, handle.y - arrowSize);
    cropCtx.lineTo(handle.x - arrowSize + 3, handle.y - arrowSize);
    cropCtx.moveTo(handle.x - arrowSize, handle.y - arrowSize);
    cropCtx.lineTo(handle.x - arrowSize, handle.y - arrowSize + 3);
    cropCtx.stroke();

    cropCtx.beginPath();
    cropCtx.moveTo(handle.x + arrowSize, handle.y + arrowSize);
    cropCtx.lineTo(handle.x + arrowSize - 3, handle.y + arrowSize);
    cropCtx.moveTo(handle.x + arrowSize, handle.y + arrowSize);
    cropCtx.lineTo(handle.x + arrowSize, handle.y + arrowSize - 3);
    cropCtx.stroke();
}

cropCanvas.addEventListener('mousedown', (e) => {
    if (session.currentStage !== 2) return;
    const { x, y } = getPointerPosition(e, cropCanvas);
    
    const handle = getResizeHandlePos();
    const distToHandle = Math.sqrt((x - handle.x) ** 2 + (y - handle.y) ** 2);

    if (distToHandle < 15) {
        isDraggingResize = true;
    } else {
        const maskX = cropMask.x - cropMask.width / 2;
        const maskY = cropMask.y - cropMask.height / 2;

        if (x >= maskX && x <= maskX + cropMask.width && y >= maskY && y <= maskY + cropMask.height) {
            isDraggingCircle = true;
            dragOffset.x = x - cropMask.x;
            dragOffset.y = y - cropMask.y;
        }
    }
});

cropCanvas.addEventListener('mousemove', (e) => {
    if (session.currentStage !== 2) return;
    const { x, y } = getPointerPosition(e, cropCanvas);
    
    if (isDraggingResize) {
        const dx = x - cropMask.x;
        const dy = y - cropMask.y;
        const dist = Math.sqrt(dx * dx + dy * dy) * 2;
        const newSize = Math.max(60, Math.min(400, dist));

        cropMask.width = newSize;
        cropMask.height = newSize;
        cropMask.x = Math.max(cropMask.width / 2, Math.min(cropCanvas.width - cropMask.width / 2, cropMask.x));
        cropMask.y = Math.max(cropMask.height / 2, Math.min(cropCanvas.height - cropMask.height / 2, cropMask.y));

        drawCropCircle();
    } else if (isDraggingCircle) {
        cropMask.x = x - dragOffset.x;
        cropMask.y = y - dragOffset.y;
        cropMask.x = Math.max(cropMask.width / 2, Math.min(cropCanvas.width - cropMask.width / 2, cropMask.x));
        cropMask.y = Math.max(cropMask.height / 2, Math.min(cropCanvas.height - cropMask.height / 2, cropMask.y));

        drawCropCircle();
    } else {
        const handle = getResizeHandlePos();
        const distToHandle = Math.sqrt((x - handle.x) ** 2 + (y - handle.y) ** 2);
        cropCanvas.style.cursor = distToHandle < 15 ? 'nwse-resize' : 'crosshair';
    }
});

cropCanvas.addEventListener('mouseup', () => {
    isDraggingCircle = false;
    isDraggingResize = false;
});

cropCanvas.addEventListener('touchstart', (e) => {
    if (session.currentStage !== 2) return;
    e.preventDefault();
    const { x, y } = getPointerPosition(e, cropCanvas);
    
    const handle = getResizeHandlePos();
    const distToHandle = Math.sqrt((x - handle.x) ** 2 + (y - handle.y) ** 2);

    if (distToHandle < 20) {
        isDraggingResize = true;
    } else {
        const maskX = cropMask.x - cropMask.width / 2;
        const maskY = cropMask.y - cropMask.height / 2;

        if (x >= maskX && x <= maskX + cropMask.width && y >= maskY && y <= maskY + cropMask.height) {
            isDraggingCircle = true;
            dragOffset.x = x - cropMask.x;
            dragOffset.y = y - cropMask.y;
        }
    }
});

cropCanvas.addEventListener('touchmove', (e) => {
    if (session.currentStage !== 2) return;
    e.preventDefault();
    const { x, y } = getPointerPosition(e, cropCanvas);
    
    if (isDraggingResize) {
        const dx = x - cropMask.x;
        const dy = y - cropMask.y;
        const dist = Math.sqrt(dx * dx + dy * dy) * 2;
        const newSize = Math.max(60, Math.min(400, dist));

        cropMask.width = newSize;
        cropMask.height = newSize;
        cropMask.x = Math.max(cropMask.width / 2, Math.min(cropCanvas.width - cropMask.width / 2, cropMask.x));
        cropMask.y = Math.max(cropMask.height / 2, Math.min(cropCanvas.height - cropMask.height / 2, cropMask.y));

        drawCropCircle();
    } else if (isDraggingCircle) {
        cropMask.x = x - dragOffset.x;
        cropMask.y = y - dragOffset.y;
        cropMask.x = Math.max(cropMask.width / 2, Math.min(cropCanvas.width - cropMask.width / 2, cropMask.x));
        cropMask.y = Math.max(cropMask.height / 2, Math.min(cropCanvas.height - cropMask.height / 2, cropMask.y));

        drawCropCircle();
    }
});

cropCanvas.addEventListener('touchend', (e) => {
    e.preventDefault();
    isDraggingCircle = false;
    isDraggingResize = false;
});

document.getElementById('confirmCropBtn').addEventListener('click', () => {
    switchStage(3);
});

// ミッション3: 保存
function createCroppedImage() {
    if (!maskLoaded || !overlayMaskLoaded) {
        console.log('Mask images not loaded yet');
        return;
    }

    const outputSize = 400;
        previewCanvas.width = outputSize;
        previewCanvas.height = outputSize;
        
        previewCtx.clearRect(0, 0, outputSize, outputSize);
        // 背景を白で塗りつぶす
        previewCtx.fillStyle = '#ffffff';
        previewCtx.fillRect(0, 0, outputSize, outputSize);
        
        const maskX = cropMask.x - cropMask.width / 2;
        const maskY = cropMask.y - cropMask.height / 2;
        const scale = outputSize / cropMask.width;

    // ステップ1: 一時キャンバスでごましおを描画
    const tempCanvas = document.createElement('canvas');
    tempCanvas.width = outputSize;
    tempCanvas.height = outputSize;
    const tempCtx = tempCanvas.getContext('2d');

    // パーティクルを一時キャンバスに描画
    session.settledParticles.forEach(particle => {
        if (particle.x >= maskX && particle.x <= maskX + cropMask.width &&
            particle.y >= maskY && particle.y <= maskY + cropMask.height) {

            const relX = particle.x - maskX;
            const relY = particle.y - maskY;
            const outputX = relX * scale;
            const outputY = relY * scale;
            const perspectiveScale = 1 / (1 + particle.z * 0.05);
            const size = particle.baseSize * perspectiveScale * scale;

            if (size < 0.5) return;

            tempCtx.save();
            tempCtx.translate(outputX, outputY);
            tempCtx.rotate(particle.rotation);

            if (particle.isBlack) {
                tempCtx.fillStyle = '#000000';
                tempCtx.beginPath();
                tempCtx.ellipse(0, 0, size, size * 0.6, 0, 0, Math.PI * 2);
                tempCtx.fill();
            } else {
                tempCtx.fillStyle = '#ffffff';
                tempCtx.beginPath();
                tempCtx.rect(-size/2, -size/2, size, size);
                tempCtx.fill();
            }

            tempCtx.restore();
        }
    });

    // ステップ2: overlayMaskImageの不透明部分を削除（透過部分にのみごましおを残す）
    // overlayMaskImageは白背景PNG、キャラクター部分は不透明なので削除
    tempCtx.globalCompositeOperation = 'destination-out';
    tempCtx.drawImage(overlayMaskImage, 0, 0, outputSize, outputSize);
    tempCtx.globalCompositeOperation = 'source-over';

    // ステップ3: メインキャンバスにごましおを描画（キャラクター以外の部分）
    previewCtx.drawImage(tempCanvas, 0, 0);

    // ステップ4: その上に透過PNG画像（maskImage）を重ねる
            previewCtx.drawImage(maskImage, 0, 0, outputSize, outputSize);
            
            // プレビュー画像を表示
            const previewImage = document.getElementById('previewImage');
            previewImage.src = previewCanvas.toDataURL('image/png');
            
            // オーバーレイも重ねて表示
            const overlayPreview = document.getElementById('overlayPreview');
            overlayPreview.src = maskImage.src;

            // 最近の作品として保存（最大3件）
            saveRecentImage(previewImage.src);
        }

document.getElementById('downloadBtn').addEventListener('click', () => {
    const link = document.createElement('a');
    link.download = 'gomasio-art.png';
    link.href = previewCanvas.toDataURL('image/png');
    link.click();
});

document.getElementById('restartBtn').addEventListener('click', () => {
    switchStage(1);
});

// 初期化
updateSliderPosition();
switchStage(1);
animate();
renderRecentImages();
